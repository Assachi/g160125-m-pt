# **–ü–æ–ª–Ω—ã–π –º–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª: –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ `Depends()` –≤ FastAPI**  

## **1. –û—Å–Ω–æ–≤—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –≤ FastAPI**

### **üìå –ü—Ä–∏–º–µ—Ä 1: –û–±—ã—á–Ω—ã–π —Ä–æ—É—Ç–∏–Ω–≥ —Å `users` –∏ `items`**

#### **üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:**
```
my_fastapi_app/
‚îÇ‚îÄ‚îÄ main.py
‚îÇ‚îÄ‚îÄ routers/
‚îÇ   ‚îú‚îÄ‚îÄ users.py
‚îÇ   ‚îú‚îÄ‚îÄ items.py
```

#### **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
- **FastAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `@app.get()`, `@app.post()` –∏ –¥—Ä—É–≥–∏–µ HTTP-–º–µ—Ç–æ–¥—ã –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏**.  
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ API –Ω–∞ –º–æ–¥—É–ª–∏ (`users.py` –∏ `items.py`) –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º –∏ —É–¥–æ–±–Ω—ã–º –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ**.  
- **–í `main.py` –º–∞—Ä—à—Ä—É—Ç—ã –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `app.include_router()`**, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–¥ –±–æ–ª–µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ.

---

#### **–§–∞–π–ª: `main.py`**
```python
from fastapi import FastAPI
from routers.users import router as users_router
from routers.items import router as items_router

app = FastAPI()

# –ü–æ–¥–∫–ª—é—á–∞–µ–º –º–∞—Ä—à—Ä—É—Ç—ã –∏–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
app.include_router(users_router, prefix="/users", tags=["users"])
app.include_router(items_router, prefix="/items", tags=["items"])

@app.get("/")
def read_root():
    return {"message": "Hello from FastAPI!"}
```

##### **–†–∞–∑–±–æ—Ä –∫–æ–¥–∞**
1. **–°–æ–∑–¥–∞—ë–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ FastAPI:**  
   - `app = FastAPI()` —Å–æ–∑–¥–∞—ë—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
  
2. **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º —Ä–æ—É—Ç–µ—Ä—ã:**  
   - `include_router(users_router, prefix="/users")` –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏–∑ `users.py`, –¥–æ–±–∞–≤–ª—è—è `/users` –≤ –Ω–∞—á–∞–ª–æ –ø—É—Ç–∏.  
   - –¢–µ–ø–µ—Ä—å `GET /users/` –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ `users.py`, –∞ `GET /items/` –≤ `items.py`.

3. **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (`/`)**  
   - `@app.get("/")` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{"message": "Hello from FastAPI!"}` –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞.

---

#### **–§–∞–π–ª: `routers/users.py`**
```python
from fastapi import APIRouter

router = APIRouter()

@router.get("/")
def list_users():
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    return [{"user_id": 1, "name": "Alice"}, {"user_id": 2, "name": "Bob"}]

@router.get("/{user_id}")
def get_user(user_id: int):
    """–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ user_id"""
    return {"user_id": user_id, "name": f"User {user_id}"}
```

##### **–†–∞–∑–±–æ—Ä –∫–æ–¥–∞**
- `APIRouter()` —Å–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç —Ä–æ—É—Ç–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–¥–µ–ª—è—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –ø–æ —Ñ–∞–π–ª–∞–º.
- `@router.get("/")` ‚Äî –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–∞—Ä—à—Ä—É—Ç–∞ `GET /users/`, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
- `@router.get("/{user_id}")` ‚Äî –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–∞—Ä—à—Ä—É—Ç–∞ `GET /users/{user_id}`, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `user_id` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

---

#### **–§–∞–π–ª: `routers/items.py`**
```python
from fastapi import APIRouter

router = APIRouter()

@router.get("/")
def list_items():
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤"""
    return [{"item_id": 101, "title": "Item A"}, {"item_id": 102, "title": "Item B"}]

@router.post("/")
def create_item(title: str):
    """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞"""
    return {"item_id": 999, "title": title}
```

##### **–†–∞–∑–±–æ—Ä –∫–æ–¥–∞**
- `@router.get("/")` ‚Üí `GET /items/` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤.
- `@router.post("/")` ‚Üí `POST /items/` —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –¥–∞–Ω–Ω—ã–µ.

‚úÖ **–ü–æ—á–µ–º—É —Ç–∞–∫ –¥–µ–ª–∞—Ç—å —É–¥–æ–±–Ω–æ?**
- **–ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏ –º–æ–¥—É–ª–∏.
- **–ì–∏–±–∫–æ—Å—Ç—å:** –ª–µ–≥–∫–æ –∏–∑–º–µ–Ω—è—Ç—å –ø—É—Ç–∏ –∏–ª–∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –¥—Ä—É–≥–∏–µ API.
- **–õ—É—á—à–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å:** –∫–æ–¥ —Ö–æ—Ä–æ—à–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –∏ –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ—Ç—Å—è.

---

## **üìå –ü—Ä–∏–º–µ—Ä 2: –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API (–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–∞–ø–∫–∞–º v1 –∏ v2)**

### **üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:**
```
my_fastapi_app_versions/
‚îÇ‚îÄ‚îÄ main.py
‚îÇ‚îÄ‚îÄ routers/
‚îÇ   ‚îú‚îÄ‚îÄ v1/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ items.py
‚îÇ   ‚îú‚îÄ‚îÄ v2/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ items.py
```

‚úÖ **–ü–æ—á–µ–º—É –Ω—É–∂–Ω–æ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API?**
- API **—Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è**, –∏ —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã–º–∏.
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ **–ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å API –±–µ–∑ —Ä–∏—Å–∫–∞ —Å–ª–æ–º–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã**.

---

### **–§–∞–π–ª: `main.py`**
```python
from fastapi import FastAPI
from routers.v1.users import router as users_v1_router
from routers.v1.items import router as items_v1_router
from routers.v2.users import router as users_v2_router
from routers.v2.items import router as items_v2_router

app = FastAPI()

# –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ä–æ—É—Ç–µ—Ä—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ API
app.include_router(users_v1_router, prefix="/api/v1/users", tags=["v1-users"])
app.include_router(items_v1_router, prefix="/api/v1/items", tags=["v1-items"])
app.include_router(users_v2_router, prefix="/api/v2/users", tags=["v2-users"])
app.include_router(items_v2_router, prefix="/api/v2/items", tags=["v2-items"])

@app.get("/")
def read_root():
    return {"message": "Welcome to the API"}
```

‚úÖ **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
- `prefix="/api/v1/users"` ‚Üí –¥–æ—Å—Ç—É–ø –∫ `users.py` –∏–∑ `v1` –ø–æ –ø—É—Ç–∏ `/api/v1/users/`.
- `prefix="/api/v2/users"` ‚Üí –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è API `/api/v2/users/`.

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ **–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é API, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—è –Ω–æ–≤—É—é**.

---

## **2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Depends()` –≤ FastAPI**

# **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ `Depends()` –≤ FastAPI**  

–¢–µ–ø–µ—Ä—å —è –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–ª —Ä–∞–∑–¥–µ–ª –ø–æ `Depends()` –∏ –¥–æ–±–∞–≤–∏–ª:  
‚úÖ **–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫—É—é —á–∞—Å—Ç—å**, –æ–±—ä—è—Å–Ω—è—é—â—É—é, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.  
‚úÖ **–ü—Ä–∏–º–µ—Ä —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ `Depends()` –≤ –æ–¥–Ω–æ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ**.  
‚úÖ **–†–∞–∑–±–æ—Ä –∫–æ–¥–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞**.  

---

## **üìå –ß—Ç–æ —Ç–∞–∫–æ–µ `Depends()`?**  

`Depends()` ‚Äî —ç—Ç–æ **–º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** (Dependency Injection, DI) –≤ FastAPI. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**, –∏–∑–±–µ–≥–∞—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞.  

### **üîπ –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Depends()`?**  
1. **–ò–∑–±–µ–≥–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞**  
   - –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–∏—Å–∞—Ç—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ª–æ–≥–∏–∫—É –≤ –∫–∞–∂–¥–æ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë.  
   
2. **–î–µ–ª–∞–µ—Ç –∫–æ–¥ —á–∏—â–µ –∏ –ø—Ä–æ—â–µ**  
   - –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –æ—Å—Ç–∞—é—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏, –±–µ–∑ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏.  

3. **–û–±–ª–µ–≥—á–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**  
   - –í —Ç–µ—Å—Ç–∞—Ö –º–æ–∂–Ω–æ **–∑–∞–º–µ–Ω—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–º–µ–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –ë–î –Ω–∞ —Ñ–∏–∫—Ç–∏–≤–Ω—É—é).  

4. **–ü–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –æ–±—ä–µ–∫—Ç–æ–≤**  
   - –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ **–æ—Ç–∫—Ä—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º** –∏ **–∑–∞–∫—Ä—ã—Ç—å –µ–≥–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞**.  

---

### **üìå –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `Depends()`**

---

#### **üìå –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤—ã–π `Depends()`**
–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ `Depends()` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç.

##### **–ö–æ–¥:**
```python
from fastapi import FastAPI, Depends

app = FastAPI()

# –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
def get_username():
    return "Alice"

@app.get("/profile")
def read_profile(username: str = Depends(get_username)):
    return {"message": f"Hello, {username}!"}
```

##### **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**  
1. `get_username()` **–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É `"Alice"`**.  
2. `Depends(get_username)` **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é** –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞.  
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏ (`Alice`) –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ `username`**, –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —ç—Ç–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.  

üìå **–ß—Ç–æ –Ω–∞–º —ç—Ç–æ –¥–∞—ë—Ç?**  
‚úÖ –¢–µ–ø–µ—Ä—å **–µ—Å–ª–∏ –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑–º–µ–Ω–∏—Ç—Å—è**, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å `get_username()` ‚Äî —ç–Ω–¥–ø–æ–∏–Ω—Ç –Ω–µ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å.  

---

#### **üìå –ü—Ä–∏–º–µ—Ä 2: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ `Depends()`**
–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Depends()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞.

##### **–ö–æ–¥:**
```python
from fastapi import FastAPI, Depends, HTTPException, status

app = FastAPI()

# –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞
def get_current_user(token: str = "fake_token"):
    if token != "secure_token":
        raise HTTPException(status_code=status.HTTP_401_UNAUTHORIZED, detail="Invalid token")
    return {"username": "Alice"}

@app.get("/dashboard")
def read_dashboard(user: dict = Depends(get_current_user)):
    return {"message": f"Welcome, {user['username']}!"}
```

##### **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
1. –ü–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ **FastAPI –≤—ã–∑—ã–≤–∞–µ—Ç `get_current_user()`**.  
2. –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (`!= "secure_token"`) ‚Üí **–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ `401 Unauthorized`**.  
3. –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –≤–µ—Ä–Ω—ã–π ‚Üí **–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** (`{"username": "Alice"}`), –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç.  

üìå **–ß—Ç–æ –Ω–∞–º —ç—Ç–æ –¥–∞—ë—Ç?**  
‚úÖ –ö–æ–¥ **–Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –≤ –∫–∞–∂–¥–æ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –Ω–∞—Å 5 –º–∞—Ä—à—Ä—É—Ç–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–æ–∫–µ–Ω–∞ –≤ –∫–∞–∂–¥–æ–º).  
‚úÖ –õ–µ–≥–∫–æ **–∏–∑–º–µ–Ω–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–π—Ç–∏ —Å —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ JWT).  

---

#### **üìå –ü—Ä–∏–º–µ—Ä 3: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `Depends()`**
–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å –ø–æ–º–æ—â—å—é `Depends()` —É–ø—Ä–∞–≤–ª—è—Ç—å **–∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –æ–±—ä–µ–∫—Ç–æ–≤**, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

##### **–ö–æ–¥:**
```python
from fastapi import FastAPI, Depends

app = FastAPI()

# –§—É–Ω–∫—Ü–∏—è-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î
def get_db():
    db = {"connection": "fake_db_connection"}  # –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
    try:
        yield db  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    finally:
        print("Closing database connection")  # –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞

@app.get("/items")
def read_items(db=Depends(get_db)):
    return {"db_status": db["connection"], "items": ["Item1", "Item2"]}
```

##### **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
1. `get_db()` **–∏–º–∏—Ç–∏—Ä—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ** (`db = {"connection": "fake_db_connection"}`).  
2. **–ò—Å–ø–æ–ª—å–∑—É–µ–º `yield`**, —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É.  
3. **–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `finally:`** ‚Üí —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è.  

üìå **–ß—Ç–æ –Ω–∞–º —ç—Ç–æ –¥–∞—ë—Ç?**  
‚úÖ –ú—ã **–Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –∏ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –ë–î –≤—Ä—É—á–Ω—É—é –≤ –∫–∞–∂–¥–æ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ**.  
‚úÖ **FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è**.  
‚úÖ **–≠—Ç–æ—Ç –∫–æ–¥ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–º–µ–Ω–∏—Ç—å `"fake_db_connection"` –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ `PostgreSQL`).  

---

#### **üìå –ü—Ä–∏–º–µ—Ä 4: –ù–µ—Å–∫–æ–ª—å–∫–æ `Depends()` –≤ –æ–¥–Ω–æ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ**
–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –≤ –æ–¥–Ω–æ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

##### **–ö–æ–¥:**
```python
from fastapi import FastAPI, Depends

app = FastAPI()

# –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è user_id
def get_user_id() -> int:
    return 123

# –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
def get_db_connection():
    db = {"connection": "fake_db_connection_object"}
    try:
        yield db
    finally:
        print("Closing db connection")

# –≠–Ω–¥–ø–æ–∏–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
@app.get("/multi-dep")
def multi_dep_example(
    user_id: int = Depends(get_user_id),
    db = Depends(get_db_connection)
):
    return {
        "user_id": user_id,
        "db_connection": db["connection"]
    }
```

##### **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
1. **–ü–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ FastAPI –≤—ã–∑—ã–≤–∞–µ—Ç –æ–±–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   - `get_user_id()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `123`.
   - `get_db_connection()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î.
2. **FastAPI –ø–µ—Ä–µ–¥–∞—ë—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞.**  
3. **–≠–Ω–¥–ø–æ–∏–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ä–∞–∑—É –¥–≤–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏!**  

üìå **–ß—Ç–æ –Ω–∞–º —ç—Ç–æ –¥–∞—ë—Ç?**  
‚úÖ –ü–æ–∑–≤–æ–ª—è–µ—Ç **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥**: –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö **—Ä–∞–∑–¥–µ–ª–µ–Ω–∞**.  
‚úÖ –õ–µ–≥–∫–æ **–¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ).  

---

#### **üìå –ò—Ç–æ–≥–∏**
| **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç `Depends()`?** | **–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?** |
|----------------------------|----------------------|
| –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞. | –≠–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è –∏ –∫–æ–¥, —É–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ. |
| –£–±–∏—Ä–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é). | –ö–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —á–∏—â–µ –∏ —É–¥–æ–±–Ω–µ–µ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏. |
| –ü–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –æ–±—ä–µ–∫—Ç–æ–≤ (`yield`). | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ë–î. |
| –î–æ—Å—Ç—É–ø–µ–Ω –≤ –ª—é–±–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ (`Depends(A), Depends(B)`). | –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –æ–¥–Ω–æ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ. |

---

### **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**
‚úÖ **`Depends()` ‚Äì –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ —É–¥–æ–±–Ω—ã–º.**  
‚úÖ **–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É**, –∞ –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ—ë –≤ –∫–∞–∂–¥–æ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ.  
‚úÖ **–û–±–ª–µ–≥—á–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É API**.  

üöÄ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Depends()`, —á—Ç–æ–±—ã –≤–∞—à FastAPI-–∫–æ–¥ –±—ã–ª –≥–∏–±–∫–∏–º –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–º!** üéØ