version: '3.9'

services:
  mysql:
    image: mysql:latest
    container_name: mysql_container
    ports:
      - "3306:3306" # Открываем стандартный порт MySQL
    environment:
      MYSQL_ROOT_PASSWORD: root_password # Задаем пароль для пользователя root
      MYSQL_DATABASE: my_database       # Создаем базу данных при запуске
      MYSQL_USER: user                  # Задаем нового пользователя
      MYSQL_PASSWORD: user_password     # Пароль для нового пользователя
    volumes:
      - ./data:/var/lib/mysql       # Монтируем том для хранения данных
      - ./mysql_logs:/var/log/mysql       # Монтируем папку логов
      - ./my.cnf:/etc/mysql/conf.d/my.cnf # Добавляем конфигурационный файл
    logging:
      driver: "json-file"
      options:
        max-size: "10m"  # Ограничение размера файла логов до 10MB
        max-file: "3"    # Хранить не более 3 файлов логов